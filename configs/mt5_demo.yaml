# MT5 Demo Trading Configuration
# ================================
# This configuration connects to MetaTrader 5 via ZeroMQ for live/demo trading.
#
# PREREQUISITES:
# 1. MT5 terminal running on Windows (VM/VPS or local machine)
# 2. DWX ZeroMQ EA installed and attached to a chart
#    Download: https://github.com/darwinex/dwxconnect
# 3. Network connectivity between this machine and MT5
#
# IMPORTANT: Use DEMO account only until fully tested!

# Run identification
run_id: mt5_demo_volatility_breakout

# MT5 ZeroMQ Connection
mt5:
  # Host where MT5 is running
  # - "localhost" if MT5 on same machine (rare on macOS)
  # - IP address of Windows machine running MT5
  zmq_host: "localhost"  # Change to your Windows machine IP

  # ZeroMQ ports (must match EA settings)
  zmq_push_port: 32768  # Commands to MT5
  zmq_pull_port: 32769  # Data from MT5

  # Connection settings
  timeout_seconds: 30

  # Symbol suffix for your broker (empty for most, "m" for micro accounts)
  symbol_suffix: ""

  # Magic number for identifying our trades (avoid conflicts with other EAs)
  magic_number: 123456

  # Reconnection settings
  retry_attempts: 3
  retry_delay_seconds: 5.0

# Trading settings
symbols:
  - EURUSD
poll_interval_seconds: 5.0  # How often to check prices and signals

# Output directory
output_dir: runs/live

# Strategy configuration (same as backtest)
strategy:
  name: volatility_breakout_live
  strategy_type: volatility_breakout
  enabled: true
  symbols:
    - EURUSD
  timeframe: M5

  # Entry/exit settings
  use_stop_loss: true
  use_take_profit: true
  risk_reward_ratio: 2.0
  time_exit_bars: 48  # Exit after 4 hours if not stopped out

  # Strategy-specific parameters
  params:
    lookback: 20           # Bars for high/low breakout
    atr_period: 14         # ATR period for volatility
    atr_threshold: 1.0     # Trade when ATR > X * avg ATR
    sl_atr_multiplier: 2.0 # Stop loss = entry +/- 2*ATR
    require_close_above: true

# Cost model (use broker's actual costs)
costs:
  commission_per_lot: 7.0
  commission_type: per_lot

  slippage_model: fixed_pips
  slippage_pips: 0.5

  use_provided_spread: true
  default_spread_pips: 1.5

# Risk management - TIGHTER for live trading
risk:
  # Per-trade limits - START CONSERVATIVE
  max_risk_per_trade_pct: 0.5   # Only risk 0.5% per trade
  max_position_size_lots: 0.1   # Max 0.1 lots (10k units)
  min_position_size_lots: 0.01  # Micro lots

  # Portfolio limits
  max_open_positions: 1         # Only 1 position at a time to start
  max_exposure_per_currency_pct: 20.0
  max_total_exposure_pct: 50.0  # Conservative exposure
  max_leverage: 5.0             # Low leverage

  # Kill switches - CRITICAL
  daily_loss_limit_pct: 2.0     # Stop if daily loss > 2%
  max_drawdown_pct: 5.0         # Kill switch at 5% drawdown
  close_positions_on_kill: true

  # Market condition filters
  max_spread_pips: 3.0          # Skip if spread too wide
  stale_price_seconds: 30.0     # Skip if price > 30s old

  # Anti-pattern protections
  no_martingale: true
  no_revenge_trading: true
  revenge_cooldown_bars: 10     # Wait 10 bars after loss

# Safety settings
max_runtime_hours: null         # null = run until stopped
close_positions_on_exit: false  # Set to true if you want auto-close
heartbeat_interval_seconds: 60.0

# Logging
log_level: INFO
